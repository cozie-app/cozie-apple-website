"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1143],{3414:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>n,metadata:()=>s,toc:()=>d});var o=a(4848),i=a(8453);const n={slug:"web_api_update",title:"Update - Web API",author:"Mario Frei",author_title:"Postdoc at BUDS Lab",author_url:"https://github.com/mariofrei",author_image_url:"../img/mario.jpeg",tags:["cozie-apple","cozie","app store","web API"]},r=void 0,s={permalink:"/blog/web_api_update",editUrl:"https://github.com/cozie-app/cozie-apple-website/tree/master/blog/2023-02-07-web_api_update.md",source:"@site/blog/2023-02-07-web_api_update.md",title:"Update - Web API",description:"We have updated the web APi for Cozie data retrieval. The change became necessary as the requests from some users exceeded the current payload limit of 6 MB.",date:"2023-02-07T00:00:00.000Z",tags:[{label:"cozie-apple",permalink:"/blog/tags/cozie-apple"},{label:"cozie",permalink:"/blog/tags/cozie"},{label:"app store",permalink:"/blog/tags/app-store"},{label:"web API",permalink:"/blog/tags/web-api"}],readingTime:.825,hasTruncateMarker:!1,authors:[{name:"Mario Frei",title:"Postdoc at BUDS Lab",url:"https://github.com/mariofrei",imageURL:"../img/mario.jpeg"}],frontMatter:{slug:"web_api_update",title:"Update - Web API",author:"Mario Frei",author_title:"Postdoc at BUDS Lab",author_url:"https://github.com/mariofrei",author_image_url:"../img/mario.jpeg",tags:["cozie-apple","cozie","app store","web API"]},unlisted:!1,prevItem:{title:"Update - Cozie v3",permalink:"/blog/update_cozie_v3"},nextItem:{title:"Update - Cozie is now on the App Store",permalink:"/blog/appStore"}},l={authorsImageUrls:[void 0]},d=[];function p(e){const t={a:"a",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(t.p,{children:["We have updated the web APi for ",(0,o.jsx)(t.a,{href:"/docs/download_data/data_download_offline",children:"Cozie data retrieval"}),". The change became necessary as the requests from some users exceeded the current payload limit of 6 MB.\n",(0,o.jsx)(t.a,{href:"/docs/download_data/data_download_offline",children:"The example script"})," was changed in to places:"]}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"The 'shutil' module needs to be imported at the beginning"}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"import shutil\n"})}),"\n",(0,o.jsxs)(t.ol,{start:"2",children:["\n",(0,o.jsx)(t.li,{children:"The new web API doesn't serve the data as JSON string. Instead, it is a two-step process. Firstly, a link is provided to a zipped .csv-file containing the data. Hence, the provided link needs to be called to then download the actual data."}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"# Download zipped CSV file with Cozie data\nwith requests.get(url, stream=True) as r:\n    with open('cozie.zip', 'wb') as f:\n        shutil.copyfileobj(r.raw, f)\n\n# Convert zipped CSV file with Cozie to dataframe\nwith open('cozie.zip', 'rb') as f:\n      df = pd.read_csv(f, compression={'method': 'zip', 'archive_name': 'sample.csv'})\n\ndf = df.drop(columns=['Unnamed: 0'])\n"})}),"\n",(0,o.jsx)(t.p,{children:"The initial call of the web API and the timezone manipulation of the dataframe remains the same, as does the resulting Pandas dataframe."})]})}function c(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}},8453:(e,t,a)=>{a.d(t,{R:()=>r,x:()=>s});var o=a(6540);const i={},n=o.createContext(i);function r(e){const t=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(n.Provider,{value:t},e.children)}}}]);