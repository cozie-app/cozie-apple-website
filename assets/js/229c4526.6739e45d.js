"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7878],{1680:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>r});var a=n(4848),i=n(8453);n(6025);const s={id:"data_download_online",title:"Download Data (online)",sidebar_label:"Download Data (online)",sidebar_position:1,slug:"download"},l=void 0,o={id:"download_data/data_download_online",title:"Download Data (online)",description:"Download the data collected using the Cozie Apple Watch survey",source:"@site/docs/2_download_data/01_data_download_online.md",sourceDirName:"2_download_data",slug:"/download_data/download",permalink:"/docs/download_data/download",draft:!1,unlisted:!1,editUrl:"https://github.com/cozie-app/cozie-apple-website/tree/master/docs/2_download_data/01_data_download_online.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"data_download_online",title:"Download Data (online)",sidebar_label:"Download Data (online)",sidebar_position:1,slug:"download"},sidebar:"myAutogeneratedSidebar",previous:{title:"Glossary",permalink:"/docs/overview/glossary"},next:{title:"Download Data (offline)",permalink:"/docs/download_data/data_download_offline"}},d={},r=[{value:"Download the data collected using the Cozie Apple Watch survey",id:"download-the-data-collected-using-the-cozie-apple-watch-survey",level:2},{value:"Watch survey data",id:"watch-survey-data",level:3},{value:"Physiological data",id:"physiological-data",level:3},{value:"Column names &amp; watch surveys",id:"column-names--watch-surveys",level:2}];function c(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"download-the-data-collected-using-the-cozie-apple-watch-survey",children:"Download the data collected using the Cozie Apple Watch survey"}),"\n",(0,a.jsx)(t.p,{children:"You can download the data you have collected using the Cozie Apple Watch survey using the following Python code."}),"\n",(0,a.jsxs)(t.p,{children:["Please note that you will have to specify your ",(0,a.jsx)(t.code,{children:"ID_PARTICIPANT"}),", ",(0,a.jsx)(t.code,{children:"ID_EXPERIMENT"}),", ",(0,a.jsx)(t.code,{children:"ID_PASSWORD"})," and ",(0,a.jsx)(t.code,{children:"API_KEY"}),". All request parameters are described in the table below."]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,a.jsx)(t.code,{children:"x-api-key"})," ",(0,a.jsx)("br",{}),"(String)"]}),(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:["Data retrieval API key needed in the request header. You can request an ",(0,a.jsx)(t.code,{children:"API_KEY"})," by emailing us a request at ",(0,a.jsx)(t.a,{href:"mailto:cozie.app@gmail.com",children:"cozie.app@gmail.com"}),"."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,a.jsx)(t.code,{children:"id_participant"})," ",(0,a.jsx)("br",{}),"(String)"]}),(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:["Identifier for an individual participant. ",(0,a.jsx)("br",{})," Can be found in the 'Settings' tab of the Cozie phone app (Participant ID)."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,a.jsx)(t.code,{children:"id_experiment"})," ",(0,a.jsx)("br",{}),"(String)"]}),(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:["Identifier for a group of participants. ",(0,a.jsx)("br",{})," Can be found in the 'Settings' tab of the Cozie phone app (Experiment ID)."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,a.jsx)(t.code,{children:"id_password"})," ",(0,a.jsx)("br",{}),"(String)"]}),(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:["Password for participant data. ",(0,a.jsx)("br",{})," Can be found in the 'Backend' tab of the Cozie phone app (Participant Password)."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,a.jsx)(t.code,{children:"columns"})," ",(0,a.jsx)("br",{}),"(List of strings)"]}),(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:["Specifies the ",(0,a.jsx)(t.a,{href:"data_overview",children:"columns"})," that are retrieved. If this parameter is omitted, all columns will be retrieved."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,a.jsx)(t.code,{children:"days"})," ",(0,a.jsx)("br",{}),"(Integer)"]}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Specifies the number of days included in the query starting from now looking back. If this parameter is omitted, all data will be retrieved."})]})]})]}),"\n",(0,a.jsxs)(t.p,{children:["The example script below shows how to call the Cozie data retrieval API and convert the received data into a Pandas dataframe (",(0,a.jsx)(t.code,{children:"df"}),"). The example below is tested with Pandas version 1.3.5."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'import requests\nimport json\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport shutil\n\n# Settings\nYOUR_TIMEZONE = "Asia/Singapore"\nAPI_KEY = ""  # Reach out to cozie.app@gmail.com for an API_KEY\nID_PARTICIPANT = "ExternalUser"\nID_EXPERIMENT = "AppleStore"\nID_PASSWORD = ""\nCOLUMNS = [\'ws_survey_count\', \'ws_heart_rate\'] # Optional\nDAYS = "2"  # Optional\n\n# Query data\npayload = {\n    "id_participant": ID_PARTICIPANT,\n    "id_experiment": ID_EXPERIMENT,\n    "id_password": ID_PASSWORD,\n    "days": DAYS, # Optional\n    "columns": COLUMNS #Optional\n}\nheaders = {"Accept": "application/json", "x-api-key": API_KEY}\nresponse = requests.get(\n    "https://69xmiejax4.execute-api.ap-southeast-1.amazonaws.com/prod/retrieve",\n    params=payload,\n    headers=headers,\n)\nurl = response.content\n\n# Download zipped CSV file with Cozie data\nwith requests.get(url, stream=True) as r:\n    with open("cozie.zip", "wb") as f:\n        shutil.copyfileobj(r.raw, f)\n\n# Convert zipped CSV file with Cozie to dataframe\nwith open("cozie.zip", "rb") as f:\n    df = pd.read_csv(f, compression={"method": "zip", "archive_name": "sample.csv"})\n\ndf = df.drop(columns=["Unnamed: 0"])\ndf["index"] = pd.to_datetime(df["index"])\ndf = df.set_index("index")\ndf.index = df.index.tz_convert(YOUR_TIMEZONE)\n\n# Display dataframe\ndf.head()\n'})}),"\n",(0,a.jsx)(t.h3,{id:"watch-survey-data",children:"Watch survey data"}),"\n",(0,a.jsx)(t.p,{children:"If you want to focus on the analysis of the watch-based survey data use the code below to filter the dataframe retrieved above."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'# Get only question flow responses\ndf_questions = df[df["ws_survey_count"].notna()]\ndf_questions.head()\n'})}),"\n",(0,a.jsx)(t.h3,{id:"physiological-data",children:"Physiological data"}),"\n",(0,a.jsx)(t.p,{children:"Use the code below to plot noise and heart rate data contained in the dataframe retrieved above."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'# Plot time-series data\nfig, ax = plt.subplots(1,2, figsize =(15, 7))\n\n# Heart rate\ndf["ts_heart_rate"].plot(ax=ax[0], style=\'.\')\nax[0].set_title("Heart Rate", fontsize=18)\nax[0].set_ylabel("Heart Rate [bpm]", fontsize=14)\nax[0].set_xlabel("Time", fontsize=14)\n\n# Noise\ndf["ts_audio_exposure_environment"].plot(ax=ax[1], style=\'.\')\nax[1].set_title("Sound Pressure", fontsize=18)\nax[1].set_ylabel("Sound Pressure [dBA]", fontsize=14)\nax[1].set_xlabel("Time", fontsize=14)\n'})}),"\n",(0,a.jsx)(t.h2,{id:"column-names--watch-surveys",children:"Column names & watch surveys"}),"\n",(0,a.jsx)(t.p,{children:"The description for all features and the watch survey questions are available on separate pages:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"data_overview",children:"Column names"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"ws_thermal_short",children:"Thermal (short)"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"ws_thermal_long",children:"Thermal (long)"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"ws_noise_and_privacy",children:"Noise and Privacy"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"ws_infection_risk",children:"Infection Risk"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"ws_movement",children:"Movement"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"ws_privacy",children:"Privacy"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"ws_interaction",children:"Interaction"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>o});var a=n(6540);const i={},s=a.createContext(i);function l(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);